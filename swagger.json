{
  "swagger": "2.0",
  "info": {
    "title": "SPI API",
    "description": "API for indoor positioning system - final project",
    "version": "1.0.0"
  },
  "consumes": ["application/json"],
  "produces": ["application/json"],
  "security": [
    {
      "ApiKey": []
    }
  ],
  "paths": {
    "/": {
      "get": {
        "x-swagger-router-controller": "root",
        "operationId": "root",
        "summary": "Root endpoint",
        "description": "Echoes app name",
        "tags": [
          "/"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          }
        }
      }
    },
    "/ping": {
      "get": {
        "x-swagger-router-controller": "root",
        "operationId": "ping",
        "summary": "Ping endpoint",
        "description": "Responds with 'pong'",
        "tags": [
          "/"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          }
        }
      }
    },
    "/buildings": {
      "post": {
        "x-swagger-router-controller": "buildings",
        "operationId": "create",
        "summary": "Create a new building",
        "tags": [
          "/buildings"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "payload",
            "description": "Map payload",
            "schema": {
              "$ref": "#/definitions/Building"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          },
          "400": {
            "$ref": "#/responses/400"
          },
          "403": {
            "$ref": "#/responses/403"
          }
        }
      },
      "get": {
        "x-swagger-router-controller": "buildings",
        "operationId": "list",
        "summary": "Get all buildings",
        "description": "",
        "tags": [
          "/buildings"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/BuildingWithId"
              }
            }
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "delete": {
        "x-swagger-router-controller": "buildings",
        "operationId": "deleteAll",
        "summary": "Delete all buildings",
        "description": "",
        "tags": [
          "/buildings"
        ],
        "parameters": [],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      }
    },
    "/buildings/{id}": {
      "get": {
        "x-swagger-router-controller": "buildings",
        "operationId": "get",
        "summary": "Get building by id",
        "description": "",
        "tags": [
          "/buildings/{id}"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "$ref": "#/definitions/BuildingWithId"
            }
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "put": {
        "x-swagger-router-controller": "buildings",
        "operationId": "update",
        "summary": "Update building information",
        "description": "",
        "tags": [
          "/buildings/{id}"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "payload",
            "description": "Map payload",
            "schema": {
              "$ref": "#/definitions/Building"
            }
          },
          {
            "in": "path",
            "name": "id",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "$ref": "#/definitions/BuildingWithId"
            }
          },
          "400": {
            "$ref": "#/responses/400"
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "delete": {
        "x-swagger-router-controller": "buildings",
        "operationId": "delete",
        "summary": "Delete a single building",
        "description": "",
        "tags": [
          "/buildings/{id}"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "id",
            "description": "The building id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      }
    },
    "/buildings/{buildingId}/samples": {
      "get": {
        "x-swagger-router-controller": "samples",
        "operationId": "list",
        "summary": "Get samples of a building by building ID",
        "description": "",
        "tags": [
          "/buildings/{buildingId}/samples"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "buildingId",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "type": "array",
              "items": {
                "$ref": "#/definitions/Sample"
              }
            }
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "post": {
        "x-swagger-router-controller": "samples",
        "operationId": "create",
        "summary": "Create a sample for a building",
        "description": "",
        "tags": [
          "/buildings/{buildingId}/samples"
        ],
        "parameters": [
          {
            "in": "body",
            "name": "payload",
            "description": "Sample payload",
            "schema": {
              "$ref": "#/definitions/Sample"
            }
          },
          {
            "in": "path",
            "name": "buildingId",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "$ref": "#/definitions/Sample"
            }
          },
          "400": {
            "$ref": "#/responses/400"
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "delete": {
        "x-swagger-router-controller": "samples",
        "operationId": "deleteAll",
        "summary": "Delete all samples for a building",
        "description": "",
        "tags": [
          "/buildings/{buildingId}/samples"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "buildingId",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "$ref": "#/definitions/Sample"
            }
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      }
    },
    "/buildings/{buildingId}/samples/{sampleId}": {
      "get": {
        "x-swagger-router-controller": "samples",
        "operationId": "get",
        "summary": "Get a single sample by building and sample ID",
        "description": "",
        "tags": [
          "/buildings/{buildingId}/samples/{sampleId}"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "buildingId",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "sampleId",
            "description": "The sample's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200",
            "schema": {
              "$ref": "#/definitions/Sample"
            }
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      },
      "delete": {
        "x-swagger-router-controller": "samples",
        "operationId": "delete",
        "summary": "Delete a single sample by ID",
        "description": "",
        "tags": [
          "/buildings/{buildingId}/samples/{sampleId}"
        ],
        "parameters": [
          {
            "in": "path",
            "name": "buildingId",
            "description": "The building's id",
            "schema": {
              "type": "string"
            }
          },
          {
            "in": "path",
            "name": "sampleId",
            "description": "The sample's id",
            "schema": {
              "type": "string"
            }
          }
        ],
        "responses": {
          "200": {
            "$ref": "#/responses/200"
          },
          "403": {
            "$ref": "#/responses/403"
          },
          "404": {
            "$ref": "#/responses/404"
          }
        }
      }
    },
    "/location": {
      "post": {
        "x-swagger-router-controller": "location",
        "operationId": "getLocation",
        "summary": "Gets the location of the user given a fingerprint and a building Id",
        "tags": [
          "/location"
        ],
        "security": [
          {
            "ApiKey": []
          }
        ],
        "parameters": [
          {
            "in": "body",
            "name": "fingerprint",
            "description": "Location body with fingerprint and id",
            "schema": {
              "$ref": "#/definitions/FingerprintWithId"
            }
          }
        ],
        "responses": {
          "201": {
            "description": "Created"
          },
          "400": {
            "description": "Bad request",
            "schema": {
            },
            "examples": {
            }
          }
        }
      }
    }
  },
  "responses": {
    "200": {
      "description": "OK"
    },
    "201": {
      "description": "Object created"
    },
    "400": {
      "description": "Bad request"
    },
    "403": {
      "description": "JWT is missing or invalid"
    },
    "404": {
      "description": "ID(s) not found"
    }
  },
  "definitions": {
    "id": {
      "type": "object",
      "properties": {
        "_id": {
          "type": "string",
          "pattern": "^[0-9a-fA-F]{24}$"
        }
      },
      "required": [
        "_id"
      ]
    },
    "Building": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "floors": {
          "type": "array",
          "items": {
            "$ref": "#/definitions/Floor"
          }
        },
        "defaultFloorId": {
          "type": "string"
        },
        "latitude": {
          "type": "number"
        },
        "longitude": {
          "type": "number"
        },
        "zoom": {
          "type": "number"
        }
      },
      "required": [
        "name",
        "floors",
        "latitude",
        "longitude",
        "zoom"
      ]
    },
    "BuildingWithId": {
      "allOf": [
        {
          "$ref": "#/definitions/id"
        },
        {
          "$ref": "#/definitions/Building"
        }
      ]
    },
    "Floor": {
      "type": "object",
      "properties": {
        "name": {
          "type": "string"
        },
        "number": {
          "type": "number"
        },
        "overlay": {
          "$ref": "#/definitions/Overlay"
        }
      },
      "required": [
        "name",
        "number",
        "overlay"
      ]
    },
    "Overlay": {
      "type": "object",
      "properties": {
        "url": {
          "type": "string"
        },
        "latitude": {
          "type": "number"
        },
        "longitude": {
          "type": "number"
        },
        "width": {
          "type": "number"
        },
        "bearing": {
          "type": "number"
        },
        "anchor_x": {
          "type": "number"
        },
        "anchor_y": {
          "type": "number"
        }
      },
      "required": [
        "url",
        "latitude",
        "longitude",
        "width",
        "bearing",
        "anchor_x",
        "anchor_y"
      ]
    },
    "Sample": {
      "type": "object",
      "properties": {
        "latitude": {
          "type": "number"
        },
        "longitude": {
          "type": "number"
        },
        "buildingId": {
          "type": "string"
        },
        "floorId": {
          "type": "string"
        },
        "fingerprint": {
          "$ref": "#/definitions/Fingerprint"
        }
      },
      "required": [
        "latitude",
        "longitude",
        "floorId",
        "fingerprint"
      ]
    },
    "FingerprintWithId": {
      "allOf": [
        {
          "$ref": "#/definitions/id"
        },
        {
          "$ref": "#/definitions/Fingerprint"
        }
      ]
    },
    "Fingerprint":
    {
      "type": "object",
      "additionalProperties": {
        "type": "number"
      },
      "example": {
        "9823472984BFA5C": -35,
        "BD4353453C3453A": -5
      }
    }
  },
  "securityDefinitions": {
    "ApiKey": {
      "type": "apiKey",
      "in": "header",
      "name": "Authorization"
    }
  }
}
